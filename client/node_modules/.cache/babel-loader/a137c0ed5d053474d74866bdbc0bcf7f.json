{"ast":null,"code":"import { call, put, select } from 'redux-saga/effects';\nimport { friendApi } from 'api/friend-api';\nimport { apiResponsesMessage } from 'data/constants/api';\nimport { addFriend, addFriends, changeFriendStatus, deleteFriend } from 'store/slices/friends-slice';\nimport { changeAuthUserAction } from 'store/slices/user-slice';\nexport function* workerGetFriends() {\n  const {\n    username\n  } = yield select(store => store.userSlice.data);\n  const response = yield call(friendApi.getFriends, username);\n\n  if (response === apiResponsesMessage.needAuth) {\n    yield put(changeAuthUserAction(false));\n  } else if (response === apiResponsesMessage.unexpected) {\n    return;\n  } else if (typeof response !== 'string') {\n    yield put(addFriends(response));\n  }\n}\n;\nexport function* workerCreateFriend(data) {\n  const {\n    friends\n  } = yield select(store => store.userSlice);\n  const response = yield call(friendApi.createFriend, data.payload);\n\n  if (response === apiResponsesMessage.needAuth) {\n    yield put(changeAuthUserAction(false));\n  } else if (response === apiResponsesMessage.unexpected) {\n    return;\n  } else if (typeof response === 'string') {\n    let friend = friends.filter(elem => elem.username === data.payload);\n    friend = { ...friend[0]\n    };\n    friend.status = response;\n    yield put(changeFriendStatus(friend));\n  } else if (typeof response !== 'string') {\n    yield put(addFriend(response));\n  }\n}\n;\nexport function* workerAcceptFriend(data) {\n  const {\n    friends\n  } = yield select(store => store.userSlice);\n  const response = yield call(friendApi.acceptFriend, data.payload);\n\n  if (response === apiResponsesMessage.needAuth) {\n    yield put(changeAuthUserAction(false));\n  } else if (response === apiResponsesMessage.unexpected) {\n    return;\n  } else if (response === apiResponsesMessage.success) {\n    let friend = friends.filter(elem => elem.username === data.payload);\n    friend = { ...friend[0]\n    };\n    friend.status = 'friend';\n    yield put(changeFriendStatus(friend));\n  }\n}\n;\nexport function* workerDeleteFriend(data) {\n  const response = yield call(friendApi.deleteFriend, data.payload);\n  if (response === apiResponsesMessage.needAuth) yield put(changeAuthUserAction(false));else if (response === apiResponsesMessage.unexpected) return;\n\n  if (response === apiResponsesMessage.success) {\n    yield put(deleteFriend(data.payload));\n  }\n}\n;","map":{"version":3,"names":["call","put","select","friendApi","apiResponsesMessage","addFriend","addFriends","changeFriendStatus","deleteFriend","changeAuthUserAction","workerGetFriends","username","store","userSlice","data","response","getFriends","needAuth","unexpected","workerCreateFriend","friends","createFriend","payload","friend","filter","elem","status","workerAcceptFriend","acceptFriend","success","workerDeleteFriend"],"sources":["E:/Uprojects/Codenk/Social-Network-main/client/src/store/sagas/friends-saga/workers.ts"],"sourcesContent":["import { call, put, select } from 'redux-saga/effects';\n\nimport { friendApi } from 'api/friend-api';\nimport { apiResponsesMessage } from 'data/constants/api';\nimport { addFriend, addFriends, changeFriendStatus, deleteFriend } from 'store/slices/friends-slice';\nimport { changeAuthUserAction } from 'store/slices/user-slice';\nimport { IFriend } from 'types/common';\nimport { IWorker } from 'types/helpers';\n\nexport function* workerGetFriends() {\n   const { username } = yield select(store => store.userSlice.data);\n\n   const response: string | IFriend[] = yield call(friendApi.getFriends, username);\n\n   if (response === apiResponsesMessage.needAuth) {\n      yield put(changeAuthUserAction(false));\n   } else if (response === apiResponsesMessage.unexpected) {\n      return;\n   } else if (typeof (response) !== 'string') {\n      yield put(addFriends(response));\n   }\n};\n\nexport function* workerCreateFriend(data: IWorker<string>) {\n   const { friends } = yield select(store => store.userSlice);\n\n   const response: string | IFriend = yield call(friendApi.createFriend, data.payload);\n\n   if (response === apiResponsesMessage.needAuth) {\n      yield put(changeAuthUserAction(false));\n   } else if (response === apiResponsesMessage.unexpected) {\n      return;\n   } else if (typeof (response) === 'string') {\n      let friend = friends.filter((elem: IFriend) => elem.username === data.payload);\n      friend = { ...friend[0] };\n      friend.status = response;\n\n      yield put(changeFriendStatus(friend));\n   } else if (typeof (response) !== 'string') {\n      yield put(addFriend(response));\n   }\n};\n\nexport function* workerAcceptFriend(data: IWorker<string>) {\n   const { friends } = yield select(store => store.userSlice);\n\n   const response: string = yield call(friendApi.acceptFriend, data.payload);\n\n   if (response === apiResponsesMessage.needAuth) {\n      yield put(changeAuthUserAction(false));\n   } else if (response === apiResponsesMessage.unexpected) {\n      return;\n   } else if (response === apiResponsesMessage.success) {\n      let friend = friends.filter((elem: IFriend) => elem.username === data.payload);\n      friend = { ...friend[0] };\n      friend.status = 'friend';\n\n      yield put(changeFriendStatus(friend));\n   }\n};\n\nexport function* workerDeleteFriend(data: IWorker<string>) {\n   const response: string = yield call(friendApi.deleteFriend, data.payload);\n\n   if (response === apiResponsesMessage.needAuth) yield put(changeAuthUserAction(false));\n   else if (response === apiResponsesMessage.unexpected) return;\n\n   if (response === apiResponsesMessage.success) {\n      yield put(deleteFriend(data.payload));\n   }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}