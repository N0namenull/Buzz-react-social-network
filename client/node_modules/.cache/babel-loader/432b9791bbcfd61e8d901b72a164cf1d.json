{"ast":null,"code":"var _jsxFileName = \"E:\\\\Uprojects\\\\Codenk\\\\Diplom\\\\client\\\\src\\\\components\\\\main-page\\\\new-post\\\\index.tsx\",\n    _s = $RefreshSig$();\n\nimport { useLayoutEffect, useRef, useState } from 'react';\nimport { sagaActionCreator, sagasConstantsPosts } from 'data/constants/saga';\nimport { useAppDispatch, useAppSelector } from 'hooks/redux';\nimport { changeTextareaHeight, handleDate, transformFile } from 'utils';\nimport { Loader } from 'components/common/loader';\nimport s from './style.module.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const NewPost = () => {\n  _s();\n\n  const dispatch = useAppDispatch();\n  const cloneField = useRef(null);\n  const [fieldOverflow, setFieldOverflow] = useState('hidden');\n  const [heightField, setHeightField] = useState(70);\n  const [post, setPost] = useState({\n    text: '',\n    img: ''\n  });\n  const {\n    status\n  } = useAppSelector(state => state.postsSlice);\n\n  const submitHandler = async e => {\n    e.preventDefault();\n    if (!post.img && !post.text) return;\n    const postData = {\n      text: post.text,\n      img: '',\n      date: handleDate()\n    };\n\n    if (typeof post.img !== 'string') {\n      postData.img = await transformFile(post.img);\n    }\n\n    dispatch(sagaActionCreator(sagasConstantsPosts.SAGA_USER_CREATE_POST, postData));\n    setPost({\n      text: '',\n      img: ''\n    });\n  };\n\n  useLayoutEffect(() => {\n    var _cloneField$current;\n\n    const cloneCurrentHeight = (_cloneField$current = cloneField.current) === null || _cloneField$current === void 0 ? void 0 : _cloneField$current.offsetHeight;\n\n    if (cloneCurrentHeight !== undefined && cloneCurrentHeight !== heightField) {\n      changeTextareaHeight(cloneCurrentHeight, setHeightField, setFieldOverflow, 220, 70);\n    }\n  });\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: submitHandler,\n    className: s.form,\n    children: [status === 'create' && /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 35\n    }, this), status === 'ready' && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: s.text,\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          className: `${s.textField} ${fieldOverflow === 'auto' ? s._auto : ''}`,\n          onChange: e => setPost({ ...post,\n            text: e.target.value\n          }),\n          value: post.text,\n          placeholder: \"Write something...\",\n          style: {\n            height: heightField + 'px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 19\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: cloneField,\n          className: s.textFieldClone,\n          children: post.text\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 19\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 16\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: s.actions,\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: `${s.inputContainer} ${post.img ? s._active : ''}`,\n          children: /*#__PURE__*/_jsxDEV(\"input\", {\n            className: s.field,\n            type: \"file\",\n            accept: \"image/jpeg, image/png\",\n            onChange: e => {\n              var _e$target$files;\n\n              return setPost({ ...post,\n                img: (_e$target$files = e.target.files) !== null && _e$target$files !== void 0 && _e$target$files.length ? e.target.files[0] : ''\n              });\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 22\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 19\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: s.submit,\n          children: \"Publish\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 19\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 16\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 7\n  }, this);\n};\n\n_s(NewPost, \"Po40REgrg8wopmcKuyAF63Riq7w=\", false, function () {\n  return [useAppDispatch, useAppSelector];\n});\n\n_c = NewPost;\n\nvar _c;\n\n$RefreshReg$(_c, \"NewPost\");","map":{"version":3,"names":["useLayoutEffect","useRef","useState","sagaActionCreator","sagasConstantsPosts","useAppDispatch","useAppSelector","changeTextareaHeight","handleDate","transformFile","Loader","s","NewPost","dispatch","cloneField","fieldOverflow","setFieldOverflow","heightField","setHeightField","post","setPost","text","img","status","state","postsSlice","submitHandler","e","preventDefault","postData","date","SAGA_USER_CREATE_POST","cloneCurrentHeight","current","offsetHeight","undefined","form","textField","_auto","target","value","height","textFieldClone","actions","inputContainer","_active","field","files","length","submit"],"sources":["E:/Uprojects/Codenk/Diplom/client/src/components/main-page/new-post/index.tsx"],"sourcesContent":["import { FC, FormEvent, useLayoutEffect, useRef, useState } from 'react';\n\nimport { sagaActionCreator, sagasConstantsPosts } from 'data/constants/saga';\nimport { useAppDispatch, useAppSelector } from 'hooks/redux';\nimport { changeTextareaHeight, handleDate, transformFile } from 'utils';\n\nimport { Loader } from 'components/common/loader';\n\nimport { FieldOverflowType, INewPostData, IPostState } from './types';\n\nimport s from './style.module.scss';\n\nexport const NewPost: FC = () => {\n   const dispatch = useAppDispatch();\n   const cloneField = useRef<HTMLDivElement | null>(null);\n\n   const [fieldOverflow, setFieldOverflow] = useState<FieldOverflowType>('hidden');\n   const [heightField, setHeightField] = useState<number>(70);\n   const [post, setPost] = useState<IPostState>({\n      text: '',\n      img: '',\n   });\n\n   const { status } = useAppSelector(state => state.postsSlice);\n\n   const submitHandler = async (e: FormEvent<HTMLFormElement>) => {\n      e.preventDefault();\n\n      if (!post.img && !post.text) return;\n\n      const postData: INewPostData = {\n         text: post.text,\n         img: '',\n         date: handleDate(),\n      };\n\n      if (typeof (post.img) !== 'string') {\n         postData.img = await transformFile(post.img);\n      }\n\n      dispatch(sagaActionCreator<INewPostData>(sagasConstantsPosts.SAGA_USER_CREATE_POST, postData));\n      setPost({ text: '', img: '' });\n   };\n\n   useLayoutEffect(() => {\n      const cloneCurrentHeight = cloneField.current?.offsetHeight;\n\n      if (cloneCurrentHeight !== undefined && cloneCurrentHeight !== heightField) {\n         changeTextareaHeight(cloneCurrentHeight, setHeightField, setFieldOverflow, 220, 70);\n      }\n   });\n\n   return (\n      <form onSubmit={ submitHandler } className={ s.form }>\n         { status === 'create' && <Loader /> }\n\n         { status === 'ready' &&\n            <>\n               <div className={ s.text }>\n                  <textarea\n                     className={ `${s.textField} ${fieldOverflow === 'auto' ? s._auto : ''}` }\n                     onChange={ e => setPost({ ...post, text: e.target.value }) }\n                     value={ post.text }\n                     placeholder=\"Write something...\"\n                     style={{ height: heightField + 'px' }}\n                  >\n                  </textarea>\n\n                  <div ref={ cloneField } className={ s.textFieldClone }>{ post.text }</div>\n               </div>\n               <div className={ s.actions }>\n                  <label className={ `${s.inputContainer} ${post.img ? s._active : ''}` }>\n                     <input\n                        className={ s.field }\n                        type=\"file\"\n                        accept=\"image/jpeg, image/png\"\n                        onChange={ e => setPost({ ...post, img: e.target.files?.length ? e.target.files[0] : '' }) }\n                     />\n                  </label>\n\n                  <button type=\"submit\" className={ s.submit }>Publish</button>\n               </div>\n            </>\n         }\n      </form>\n   );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}